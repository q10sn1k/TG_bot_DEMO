Архитектура проекта


```
├── app
│   ├── config
│   │   ├── __init__.py
│   │   ├── settings.py
│   ├── __init__.py
│   ├── database.py
│   ├── handlers
│   │   ├── __init__.py
│   │   └── todo_handler.py
│   ├── keyboards
│   │   ├── __init__.py
│   │   └── todo_keyboard.py
│   ├── models.py
│   ├── states.py
│   └── utils.py
├── env
├── requirements.txt
└── app.py
```

* `app/config/__init__.py`: модуль, объединяющий настройки приложения
* `app/config/settings.py`: модуль, содержащий настройки приложения
* `app/__init__.py`: модуль, объединяющий все компоненты приложения
* `app/database.py`: модуль для работы с базой данных
* `app/handlers/__init__.py`: пакет, содержащий все обработчики для приложения
* `app/handlers/todo_handler.py`: модуль, содержащий обработчики команд, связанных с задачами (TODO)
* `app/keyboards/__init__.py`: пакет, содержащий все клавиатуры для приложения
* `app/keyboards/todo_keyboard.py`: модуль, содержащий клавиатуру для списка задач (TODO)
* `states.py`: файл содержит функцию-декоратор для добавления State'ов к классу, а также пример использования этой функции для создания StatesGroup с двумя State'ами.
* `app/models.py`: модуль, содержащий модели для работы с базой данных
* `app/utils.py`: модуль с вспомогательными функциями для приложения
* `env`: каталог с настройками виртуального окружения Python
* `requirements.txt`: файл с зависимостями проекта
* `app.py`: главный файл приложения, в котором создается и запускается экземпляр бота и регистрируются обработчики команд и событий.




# Получение токена
![img.png](readme_images/init_token.png)

# Процесс разработки

* Настройте `config` и `.env`

* Установите библиотеку aiogram с помощью команды `pip install aiogram`. \
Эта библиотека позволяет создавать ботов для Telegram на языке Python.

Создайте файл main.py и импортируйте необходимые модули, такие как aiogram, config, handlers ...

* Создайте нового бота в Telegram, следуя инструкциям на сайте Telegram. Получите токен бота и добавьте его в файл config/settings.py, создав новую переменную BOT_TOKEN.

* Создайте модуль handlers/todo_handler.py, который будет обрабатывать команды для списка задач. Реализуйте методы для обработки команды /start, добавления новой задачи, удаления всех задач и отмены добавления новой задачи.

* Создайте модуль keyboards/todo_keyboard.py, который будет создавать кастомную клавиатуру для управления списком задач.

* Создайте модуль database.py, который будет создавать соединение с базой данных и создавать необходимые таблицы в базе данных.

* Создайте модуль models.py, который будет описывать модели для базы данных, включая модель для задач.

* Создайте модуль utils.py, который будет содержать вспомогательные функции для работы с задачами.

* В модуле main.py создайте экземпляр бота, подключите обработчики из модуля handlers/todo_handler.py и запустите бота.

* Запустите скрипт main.py, чтобы запустить бота и проверить его работоспособность.


# Поэтапный процесс разработки

Сначала подготовьте базу данных (MySql):

`.env`
```dotenv
TOKEN=your_bot_token
DATABASE_URL=mysql://username:password@localhost/db_name
```

1. Создание структуры проекта:

* Создание корневой папки проекта.
* Создание папки `app`, в которой будут находиться файлы приложения.
* Создание папки `config` внутри папки `app`, в которой будут находиться файлы конфигурации.
* Создание пустого файла `__init__.py` внутри папки app и внутри папок `config, handlers, keyboards, states, utils`.
* Создание файла `database.py` внутри папки app, где будут находиться функции для работы с базой данных.
* Создание файла `models.py` внутри папки `app`, где будут находиться модели для базы данных.
* Создание файла `todo_keyboard.py` внутри папки `app/keyboards`, где будут находиться функции для создания клавиатуры списка задач.
* Создание файла `states.py` внутри папки app, где будут находиться состояния для FSM.
* Создание файла `todo_handler.py` внутри папки `app/handlers`, где будут находиться функции для обработки команд пользователя.
* Создание файла `utils.py` внутри папки `app`, где будут находиться вспомогательные функции.
* Создание файла `settings.py` внутри папки `config`, где будут находиться настройки приложения.
* Создание файла `requirements.txt`, где будут указаны зависимости проекта.

2. Настройка окружения:

* Создание виртуального окружения.
* Активация виртуального окружения.
* Установка зависимостей из requirements.txt.

3. Настройка базы данных:

* Импорт модуля create_engine из библиотеки sqlalchemy.
* Создание объекта engine, используя create_engine и указав путь к базе данных.
* Импорт модуля Base из sqlalchemy.ext.declarative.
* Создание объекта Base.metadata, используя Base.metadata.create_all(bind=engine) для создания таблиц в базе данных.

4. Настройка клавиатуры:

* Импорт модуля ReplyKeyboardMarkup из `aiogram.types`.
* Создание объекта TodoKeyboard с помощью `ReplyKeyboardMarkup`.

5. Настройка FSM:

* Импорт модуля `FSMContext` из `aiogram.dispatcher`.
* Импорт модуля `state` из `aiogram.dispatcher.filters`.
* Импорт модуля `StatesGroup` из `aiogram.dispatcher.filters.state`.
* Создание класса `TodoHandler`, унаследованного от StatesGroup, в котором будут находиться состояния для FSM.

6. Настройка обработчиков команд и callback-ов

7. Реализовали базовые функции обработки задач в `todo_handler.py`, используя aiogram и sqlalchemy. В файле были созданы State'ы, настроен обработчик команды start, добавления и удаления задач, а также отмены добавления новой задачи.

8. Создали клавиатуру для взаимодействия с задачами в `todo_keyboard.py`. Добавили кнопки для добавления новой задачи и удаления всех задач.

9. Добавили модели TodoTask и Base в `models.py`, чтобы можно было создать таблицу задач в базе данных.

10. Написали утилиту `create_todo_list` в `utils.py` для форматирования списка задач перед выводом в чат.

11. Создали файл `states.py`, где определили функцию state_factory для автоматического добавления State'ов к классам-обработчикам.

12. Добавили файл `settings.py` в папку config для хранения конфигурационных параметров, таких как токен бота и параметры подключения к базе данных.

13. Создали основной файл приложения `app.py`, который настраивает логгирование, создает объекты бота и диспетчера, а также подключается к базе данных. Также были добавлены обработчики для запуска бота и обработки ошибок.

14. Запустили приложение и проверили его работоспособность в телеграм-чате. `python app.py`





Создание файла с зависимости проекта:

```
pip freeze > requirements.txt 
```


Бот:

![img.png](readme_images/bot1.png)

![img.png](readme_images/bot2.png)